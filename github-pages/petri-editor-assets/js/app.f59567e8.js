(function(){"use strict";var t={7937:function(t,e,a){var n=a(9963),s=a(8139),o=a(8947),r=a(7810),i=a(1436),l=a(6024),d=a(9669),c=a.n(d),u=a(5382),p=a.n(u),m=a(6252);const f={class:"app-container"};function h(t,e,a,n,s,o){const r=(0,m.up)("router-view");return(0,m.wg)(),(0,m.j4)("div",f,[(0,m.Wm)(r)])}var g={name:"App"};g.render=h;var y=g,b=a(2119);const w=(0,m.HX)("data-v-fe25df0c");(0,m.dD)("data-v-fe25df0c");const E={class:"error-page"},v=(0,m.Wm)("h1",null,[(0,m.Uk)("500 "),(0,m.Wm)("span",{style:{color:"#F56C6C"}},"Internal Server Error")],-1),S=(0,m.Wm)("h3",null,"Oops... Something went wrong.",-1),x=(0,m.Wm)("p",null,[(0,m.Uk)("Try going back and attempting the action again after some time. "),(0,m.Wm)("br"),(0,m.Uk)("Feel free to contact us if the problem persist.")],-1),k=(0,m.Uk)("Go to home page");(0,m.Cn)();const I=w(((t,e,a,n,s,o)=>{const r=(0,m.up)("el-divider"),i=(0,m.up)("el-button");return(0,m.wg)(),(0,m.j4)("div",E,[v,S,(0,m.Wm)(r),x,(0,m.Wm)(i,{type:"primary",onClick:o.goToHomePage},{default:w((()=>[k])),_:1},8,["onClick"])])}));var T={methods:{goToHomePage(){this.$router.push("/")}}};T.render=I,T.__scopeId="data-v-fe25df0c";var $=T;const W=(0,m.HX)("data-v-e97d3f30"),j=W(((t,e,a,n,s,o)=>{const r=(0,m.up)("EditorProperties"),i=(0,m.up)("el-aside"),l=(0,m.up)("Workspace"),d=(0,m.up)("el-main"),c=(0,m.up)("el-container"),u=(0,m.Q2)("loading");return(0,m.wy)(((0,m.wg)(),(0,m.j4)(c,{class:"page-container"},{default:W((()=>[(0,m.Wm)(i,{width:"15%"},{default:W((()=>[(0,m.Wm)(r)])),_:1}),(0,m.Wm)(c,null,{default:W((()=>[(0,m.Wm)(d,null,{default:W((()=>[(0,m.Wm)(l)])),_:1})])),_:1})])),_:1},512)),[[u,s.loading]])})),_=(0,m.HX)("data-v-2a5bc2e4");(0,m.dD)("data-v-2a5bc2e4");const C={class:"editor-Properties"},V=(0,m.Wm)("h3",null,"Properties",-1);(0,m.Cn)();const N=_(((t,e,a,n,s,o)=>{const r=(0,m.up)("ExecutionMenu"),i=(0,m.up)("el-collapse-item"),l=(0,m.up)("SelectedElementMenu"),d=(0,m.up)("el-collapse");return(0,m.wg)(),(0,m.j4)("div",C,[V,(0,m.Wm)(d,{modelValue:s.activeItems,"onUpdate:modelValue":e[1]||(e[1]=t=>s.activeItems=t)},{default:_((()=>[(0,m.Wm)(i,{title:"Execution",name:"execution"},{default:_((()=>[(0,m.Wm)(r)])),_:1}),(0,m.Wm)(i,{title:"Selected element",name:"selectedElement"},{default:_((()=>[(0,m.Wm)(l)])),_:1}),(0,m.Wm)(i,{title:"Storage",name:"storage"})])),_:1},8,["modelValue"])])})),P={class:"execution-menu"};function O(t,e,a,n,s,o){const r=(0,m.up)("el-input"),i=(0,m.up)("el-form-item"),l=(0,m.up)("el-form");return(0,m.wg)(),(0,m.j4)("div",P,[(0,m.Wm)(l,{"label-width":"30%",size:"mini"},{default:(0,m.w5)((()=>[(0,m.Wm)(i,{label:"Step"},{default:(0,m.w5)((()=>[(0,m.Wm)(r,{modelValue:o.step,"onUpdate:modelValue":e[1]||(e[1]=t=>o.step=t),readonly:""},null,8,["modelValue"])])),_:1}),(0,m.Wm)(i,{label:"Logs"},{default:(0,m.w5)((()=>[(0,m.Wm)(r,{type:"textarea",modelValue:o.logs,"onUpdate:modelValue":e[2]||(e[2]=t=>o.logs=t),readonly:"",placeholder:"empty",autosize:{minRows:3,maxRows:6},resize:"none"},null,8,["modelValue"])])),_:1})])),_:1})])}var z={name:"ExecutionMenu",computed:{step(){return this.$store.getters.step},logs(){return this.$store.getters.logsString}}};z.render=O;var F=z,A=a(3577);const M={class:"selected-element-menu"},D={class:"select-item"},L={class:"select-item"};function U(t,e,a,n,s,o){const r=(0,m.up)("el-empty"),i=(0,m.up)("el-input"),l=(0,m.up)("el-form-item"),d=(0,m.up)("el-option"),c=(0,m.up)("el-select"),u=(0,m.up)("el-form");return(0,m.wg)(),(0,m.j4)("div",M,[o.selectedElement?"place"===o.selectedElement.type?((0,m.wg)(),(0,m.j4)(u,{key:1,"label-width":"30%",size:"mini"},{default:(0,m.w5)((()=>[(0,m.Wm)(l,{label:"Label"},{default:(0,m.w5)((()=>[(0,m.Wm)(i,{modelValue:o.selectedElement.attrs.label,"onUpdate:modelValue":e[1]||(e[1]=t=>o.selectedElement.attrs.label=t),onInput:o.updateLabel},null,8,["modelValue","onInput"])])),_:1}),(0,m.Wm)(l,{label:"Datatype"},{default:(0,m.w5)((()=>[(0,m.Wm)(c,{modelValue:o.selectedElement.attrs.dataType,"onUpdate:modelValue":e[2]||(e[2]=t=>o.selectedElement.attrs.dataType=t),filterable:"",onChange:o.updateDataType},{default:(0,m.w5)((()=>[((0,m.wg)(!0),(0,m.j4)(m.HY,null,(0,m.Ko)(o.dataTypes,(t=>((0,m.wg)(),(0,m.j4)(d,{key:t,label:t,value:t},{default:(0,m.w5)((()=>[(0,m.Wm)("span",D,(0,A.zw)(t),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),(0,m.Wm)(l,{label:"Initial state"},{default:(0,m.w5)((()=>[(0,m.Wm)(i,{type:"textarea",modelValue:o.selectedElement.attrs.initialStateString,"onUpdate:modelValue":e[3]||(e[3]=t=>o.selectedElement.attrs.initialStateString=t),placeholder:"empty",autosize:{minRows:3,maxRows:6},resize:"none",onInput:o.updateInitialStateString},null,8,["modelValue","onInput"])])),_:1}),(0,m.Wm)(l,{label:"Current state"},{default:(0,m.w5)((()=>[(0,m.Wm)(i,{type:"textarea",modelValue:o.selectedElement.attrs.currentStateString,"onUpdate:modelValue":e[4]||(e[4]=t=>o.selectedElement.attrs.currentStateString=t),placeholder:"empty",autosize:{minRows:3,maxRows:6},resize:"none",readonly:""},null,8,["modelValue"])])),_:1}),(0,m.Wm)(l,{label:"Count"},{default:(0,m.w5)((()=>[(0,m.Wm)(i,{modelValue:o.selectedElement.attrs.count,"onUpdate:modelValue":e[5]||(e[5]=t=>o.selectedElement.attrs.count=t),readonly:""},null,8,["modelValue"])])),_:1})])),_:1})):"transition"===o.selectedElement.type?((0,m.wg)(),(0,m.j4)(u,{key:2,"label-width":"30%",size:"mini"},{default:(0,m.w5)((()=>[(0,m.Wm)(l,{label:"Label"},{default:(0,m.w5)((()=>[(0,m.Wm)(i,{modelValue:o.selectedElement.attrs.label,"onUpdate:modelValue":e[6]||(e[6]=t=>o.selectedElement.attrs.label=t),onInput:o.updateLabel},null,8,["modelValue","onInput"])])),_:1}),(0,m.Wm)(l,{label:"Action"},{default:(0,m.w5)((()=>[(0,m.Wm)(c,{modelValue:o.selectedElement.attrs.action,"onUpdate:modelValue":e[7]||(e[7]=t=>o.selectedElement.attrs.action=t),filterable:"",onChange:o.updateAction},{default:(0,m.w5)((()=>[((0,m.wg)(!0),(0,m.j4)(m.HY,null,(0,m.Ko)(o.actions,(t=>((0,m.wg)(),(0,m.j4)(d,{key:t.name,label:t.name,value:t.name},{default:(0,m.w5)((()=>[(0,m.Wm)("span",L,(0,A.zw)(t.name),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),(0,m.Wm)(l,{label:"Status"},{default:(0,m.w5)((()=>[(0,m.Wm)(i,{modelValue:o.selectedElement.attrs.status,"onUpdate:modelValue":e[8]||(e[8]=t=>o.selectedElement.attrs.status=t),readonly:""},null,8,["modelValue"])])),_:1})])),_:1})):(0,m.kq)("",!0):((0,m.wg)(),(0,m.j4)(r,{key:0,description:"No element selected"}))])}var R={name:"SelectedElementMenu",data(){return{}},computed:{selectedElement(){return this.$store.getters.selectedElement},actions(){return this.$store.getters.actions},dataTypes(){return this.$store.getters.dataTypes}},methods:{updateLabel(t){this.$store.commit("updateElementLabel",t)},updateDataType(t){this.$store.commit("updateElementDataType",t)},updateInitialStateString(t){this.$store.commit("updateElementInitialStateString",t)},updateAction(t){this.$store.commit("updateElementAction",t)}}};R.render=U;var B=R,X={name:"EditorProperties",data(){return{activeItems:["execution","selectedElement"]}},components:{ExecutionMenu:F,SelectedElementMenu:B}};X.render=N,X.__scopeId="data-v-2a5bc2e4";var H=X;const Y=(0,m.HX)("data-v-759a7d58");(0,m.dD)("data-v-759a7d58");const G=(0,m.Wm)("div",{id:"paper"},null,-1),q=(0,m.Uk)("Display");(0,m.Cn)();const J=Y(((t,e,a,n,s,o)=>{const r=(0,m.up)("ControlBar"),i=(0,m.up)("el-tab-pane"),l=(0,m.up)("el-tabs");return(0,m.wg)(),(0,m.j4)(l,{type:"border-card",class:"el-tabs"},{default:Y((()=>[(0,m.Wm)(i,{label:s.modelName,class:"tab-content"},{default:Y((()=>[(0,m.Wm)(r),G])),_:1},8,["label"]),(0,m.Wm)(i,{label:"Display"},{default:Y((()=>[q])),_:1})])),_:1})})),K=(0,m.HX)("data-v-bcab461c");(0,m.dD)("data-v-bcab461c");const Z={class:"control-bar"},Q=(0,m.Wm)("i",{class:"fas fa-mouse-pointer"},null,-1),tt=(0,m.Wm)("i",{class:"fas fa-circle"},null,-1),et=(0,m.Wm)("i",{class:"fas fa-square"},null,-1),at=(0,m.Wm)("i",{class:"fas fa-bolt"},null,-1),nt=(0,m.Wm)("i",{class:"fas fa-fast-backward"},null,-1),st=(0,m.Wm)("i",{class:"fas fa-step-forward"},null,-1);(0,m.Cn)();const ot=K(((t,e,a,n,s,o)=>{const r=(0,m.up)("el-button"),i=(0,m.up)("el-tooltip"),l=(0,m.up)("el-button-group");return(0,m.wg)(),(0,m.j4)("div",Z,[(0,m.Wm)(l,{class:"tools"},{default:K((()=>[(0,m.Wm)(i,{class:"item",effect:"dark",content:"Cursor tool",placement:"top-start","show-after":2400},{default:K((()=>[(0,m.Wm)(r,{type:s.btnType.cursor,size:"mini",onClick:e[1]||(e[1]=t=>o.selectTool("cursor"))},{default:K((()=>[Q])),_:1},8,["type"])])),_:1}),(0,m.Wm)(i,{class:"item",effect:"dark",content:"Place tool",placement:"top-start","show-after":2400},{default:K((()=>[(0,m.Wm)(r,{type:s.btnType.place,size:"mini",onClick:e[2]||(e[2]=t=>o.selectTool("place"))},{default:K((()=>[tt])),_:1},8,["type"])])),_:1}),(0,m.Wm)(i,{class:"item",effect:"dark",content:"Transition tool",placement:"top-start","show-after":2400},{default:K((()=>[(0,m.Wm)(r,{type:s.btnType.transition,size:"mini",onClick:e[3]||(e[3]=t=>o.selectTool("transition"))},{default:K((()=>[et])),_:1},8,["type"])])),_:1}),(0,m.Wm)(i,{class:"item",effect:"dark",content:"Execute tool",placement:"top-start","show-after":2400},{default:K((()=>[(0,m.Wm)(r,{type:s.btnType.execute,size:"mini",onClick:e[4]||(e[4]=t=>o.selectTool("execute"))},{default:K((()=>[at])),_:1},8,["type"])])),_:1})])),_:1}),(0,m.Wm)(l,{class:"simulation"},{default:K((()=>[(0,m.Wm)(i,{class:"item",effect:"dark",content:"Fast backward",placement:"top-start","show-after":2400},{default:K((()=>[(0,m.Wm)(r,{type:"default",size:"mini",onClick:e[5]||(e[5]=t=>o.fastBackward())},{default:K((()=>[nt])),_:1})])),_:1}),(0,m.Wm)(i,{class:"item",effect:"dark",content:"Step forward",placement:"top-start","show-after":2400},{default:K((()=>[(0,m.Wm)(r,{type:"default",size:"mini",onClick:e[6]||(e[6]=t=>o.stepForward())},{default:K((()=>[st])),_:1})])),_:1})])),_:1})])}));var rt={name:"ControlBar",data(){return{btnType:{cursor:"primary",place:"default",transition:"default",execute:"default"}}},computed:{tool(){return this.$store.getters.tool}},methods:{selectTool(t){this.btnType[this.tool]="default",this.$store.commit("selectTool",t),this.btnType[this.tool]="primary"},fastBackward(){this.$store.commit("resetState")},stepForward(){this.$store.commit("stepForward")}}};rt.render=ot,rt.__scopeId="data-v-bcab461c";var it=rt,lt={name:"Workspace",data(){return{modelName:"MyTestModel"}},components:{ControlBar:it}};lt.render=J,lt.__scopeId="data-v-759a7d58";var dt=lt;let ct,ut,pt=!1;const mt="#67C23A",ft="http://vps-d38373e3.vps.ovh.net:5000",ht={attrs:{body:{strokeWidth:2,cx:0,cy:0,rx:40,ry:40,stroke:"#8f8f8f",fill:"#FFFFFF"},label:{ref:"body",textVerticalAnchor:"bottom",textAnchor:"middle",refX:"50%",refY:"0%",fontSize:12,fill:"#6d6d6d",text:"New Place"},dataType:{ref:"body",textVerticalAnchor:"top",textAnchor:"left",refX:"90%",refY:"90%",fontSize:12,fill:"#6d6d6d",text:"integer"},initialState:{ref:"body",textVerticalAnchor:"top",textAnchor:"left",refX:"105%",refY:"5%",fontSize:12,fill:mt,text:"[]"},count:{ref:"body",textVerticalAnchor:"middle",textAnchor:"middle",refX:"50%",refY:"50%",fontSize:12,fill:"#6d6d6d",text:"0"}}},gt={markup:[{tagName:"ellipse",selector:"body",attributes:{magnet:"on-ctrl"}},{tagName:"text",selector:"label"},{tagName:"text",selector:"dataType"},{tagName:"text",selector:"initialState"},{tagName:"text",selector:"count"}]},yt={ports:{groups:{input:{attrs:{circle:{fill:"#409EFF",stroke:"none",r:5,magnet:"passive","data-name":"","data-type":""},text:{fontSize:12,fill:"#6d6d6d"}},label:{position:"insideOriented"},position:{name:"line",args:{start:{x:-120,y:-40},end:{x:-120,y:40}}}},output:{attrs:{circle:{fill:"#67C23A",stroke:"none",r:5,magnet:"on-ctrl","data-name":"","data-type":""},text:{fontSize:12,fill:"#6d6d6d"}},label:{position:"insideOriented"},position:{name:"line",args:{start:{x:120,y:-40},end:{x:120,y:40}}}}}},attrs:{".":{magnet:!1},body:{refx:"100%",refy:"100%",strokeWidth:2,x:-120,y:-40,width:240,height:80,rx:4,ry:4,stroke:"#8f8f8f",fill:"#FFFFFF"},label:{ref:"body",textVerticalAnchor:"bottom",textAnchor:"middle",refX:"50%",refY:"0%",fontSize:12,fill:"#6d6d6d",text:"New Transition"},action:{ref:"body",textVerticalAnchor:"middle",textAnchor:"middle",refX:"105%",refY:"110%",fontSize:12,fill:"#6d6d6d",text:""}}},bt={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"},{tagName:"text",selector:"action"}]};var wt={components:{EditorProperties:H,Workspace:dt},data(){return{loading:!0}},computed:{tool(){return this.$store.getters.tool},selectedElement(){return this.$store.getters.selectedElement},step(){return this.$store.getters.step},actions(){return this.$store.getters.actions},dataTypes(){return this.$store.getters.dataTypes},graph:{get(){return this.$store.getters.graph},set(t){this.$store.commit("setGraph",t)}},paperEl:{get(){return this.$store.getters.paperEl},set(t){this.$store.commit("setPaperEl",t)}},paper:{get(){return this.$store.getters.paper},set(t){this.$store.commit("setPaper",t)}}},methods:{drag(t,e){if("cursor"===this.tool&&pt){const a=t-ut,n=e-ct;this.paper.setOrigin(this.paper.options.origin.x+a,this.paper.options.origin.y+n),window.$("body").css("cursor","grabbing")}},startDrag(t,e){"cursor"===this.tool&&(this.paper.setInteractivity({elementMove:!1}),ut=t,ct=e,pt=!0)},stopDrag(){this.paper.setInteractivity({elementMove:!0}),pt=!1,window.$("body").css("cursor","auto")},setUpPaper(){window.joint.dia.Element.define("psim.Place",ht,gt),window.joint.dia.Element.define("psim.Transition",yt,bt),this.graph=new window.joint.dia.Graph,this.paperEl=window.$("#paper"),this.paper=new window.joint.dia.Paper({el:this.paperEl,model:this.graph,width:this.paperEl.width(),height:this.paperEl.height(),gridSize:10,drawGrid:!0,linkPinning:!1,defaultLink:()=>new window.joint.shapes.standard.Link({router:{name:"orthogonal",args:{step:10,perpendicular:!0}}}),validateMagnet:(t,e,a)=>"on-ctrl"===e.getAttribute("magnet")&&a.ctrlKey,validateConnection:(t,e,a,n,s,o)=>{if(t.model.attributes.type===a.model.attributes.type)return!1;if(!a||!n)return!1;if("output"===n.getAttribute("port-group"))return!1;if("psim.Place"===t.model.attributes.type&&t.model.attributes.attrs.dataType.text!==n.attributes["data-type"].nodeValue)return!1;if("psim.Transition"===t.model.attributes.type&&a.model.attributes.attrs.dataType.text!==e.attributes["data-type"].nodeValue)return!1;if("psim.Transition"===a.model.attributes.type){const t=this.graph.getLinks().some((t=>t.id!==o.model.id&&t.get("target").id===a.model.id&&t.get("target").port===n.getAttribute("port")));if(t)return!1}return!0}}),this.paper.on({"element:mouseenter":t=>{"psim.Place"!==t.model.attributes.type?"psim.Transition"===t.model.attributes.type&&t.addTools(new window.joint.dia.ToolsView({tools:[new window.joint.elementTools.Remove({useModelGeometry:!0,x:"0%",y:"0%",action:(t,e,a)=>{this.$store.commit("removeTransition",e.model.id),e.model.remove({ui:!0,tool:a.cid})},offset:{x:120,y:-40}})]})):t.addTools(new window.joint.dia.ToolsView({tools:[new window.joint.elementTools.Remove({useModelGeometry:!0,x:"50%",y:"50%",action:(t,e,a)=>{this.$store.commit("removePlace",e.model.id),e.model.remove({ui:!0,tool:a.cid})},offset:{x:-30,y:30}})]}))},"link:connect":(t,e,a,n)=>{const s=a.model.attributes.type;if("psim.Transition"===s)this.$store.commit("addInputLink",{placeId:t.model.get("source").id,transitionId:t.model.get("target").id,portName:n.attributes["data-name"].nodeValue});else if("psim.Place"===s){const e=this.graph.getCell(t.model.get("source").id).getPort(t.model.get("source").port);this.$store.commit("addOutputLink",{placeId:a.model.attributes.id,transitionId:t.model.get("source").id,portName:e.attrs.circle["data-name"]})}},"link:mouseenter":t=>{t.addTools(new window.joint.dia.ToolsView({tools:[new window.joint.linkTools.Vertices({snapRadius:0}),new window.joint.linkTools.Remove({distance:20,action:(t,e,a)=>{const n=e.model.get("source"),s=e.model.get("target");let o={};if("body"===n.magnet){const t=this.graph.getCell(s.id).getPort(s.port);o={placeId:n.id,transitionId:s.id,portName:t.attrs.circle["data-name"]},this.$store.commit("removeInputLink",o)}else if("circle"===n.magnet){const t=this.graph.getCell(n.id).getPort(n.port);o={placeId:s.id,transitionId:n.id,portName:t.attrs.circle["data-name"]},this.$store.commit("removeOutputLink",o)}e.model.remove({ui:!0,tool:a.cid})}})]}))},"cell:mouseleave":t=>{t.removeTools()},"cell:pointerclick":async t=>{if("cursor"===this.tool){if(this.selectedElement){const t=this.$store.getters.getCellViewById(this.selectedElement.id);t.unhighlight()}const e=this.$store.getters.getElementById(t.model.id);return this.$store.commit("selectElement",e),void t.highlight()}"execute"===this.tool&&await this.$store.commit("fireTransition",t.model.attributes.id)},"blank:pointerclick":(t,e,a)=>{if("transition"!==this.tool)if("place"!==this.tool){if("cursor"===this.tool&&this.selectedElement){const t=this.$store.getters.getCellViewById(this.selectedElement.id);t.unhighlight(),this.$store.commit("selectElement",void 0)}}else{const t=new window.joint.shapes.psim.Place;t.position(e,a),t.addTo(this.graph);const n={id:t.id,type:"place",attrs:{label:"New Place",dataType:"integer",initialState:[],initialStateString:"",currentState:[],currentStateString:"",inputs:[],outputs:[],count:0}};this.$store.commit("addElement",n)}else{const t=new window.joint.shapes.psim.Transition;t.position(e,a),t.addTo(this.graph);const n={id:t.id,type:"transition",attrs:{label:"New Transition",action:"",inputs:{},outputs:{},status:"Enabled"}};this.$store.commit("addElement",n)}},"blank:pointerdown":(t,e,a)=>{this.startDrag(e,a)},"cell:pointermove":(t,e,a)=>{this.drag(e,a)},"blank:pointermove":(t,e,a)=>{this.drag(e,a)},"cell:pointerup":()=>{this.stopDrag()},"blank:pointerup":()=>{this.stopDrag()},"paper:mouseleave":()=>{this.stopDrag()}})}},async mounted(){try{await this.$loadScript("https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.js"),await this.$loadScript("https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.20/lodash.js"),await this.$loadScript("https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.4.0/backbone.js"),await this.$loadScript("https://cdnjs.cloudflare.com/ajax/libs/jointjs/3.3.1/joint.js");const t=await this.axios.get(`${ft}/actions`);this.actions.push(...t.data);const e=await this.axios.get(`${ft}/types`);this.dataTypes.push(...e.data),this.setUpPaper()}catch(t){console.log(t),this.$alert("Failed to load 3rd party libraries","Error",{confirmButtonText:"OK",type:"error",callback:()=>{this.$router.push("500")}})}finally{this.loading=!1}}};wt.render=j,wt.__scopeId="data-v-e97d3f30";var Et=wt;const vt=[{path:"/",name:"Editor",component:Et},{path:"/500",name:"InternalServerError",component:$}],St=(t,e)=>t.map((t=>({...t,path:`/${e}${t.path}`,name:`${e}-${t.name}`})));console.log(vt.concat(St(vt,"editor")));const xt=(0,b.p7)({history:(0,b.PO)(),routes:vt.concat(St(vt,"editor"))});var kt=xt,It=a(4709),Tt=a(1173);const $t="http://localhost:5000",Wt="#67C23A",jt="#F56C6C",_t={Enabled:"#8f8f8f",Disabled:jt,Ready:Wt},Ct=t=>{if(t.length>8){let e="";for(let a=0;a<t.length;a+=8){if(a>16){e+="...";break}a+8<t.length?e+=`${t.slice(a,a+8)}\n `:e+=`${t.slice(a,a+8)}`}return e}return t},Vt=async(t,e)=>{const a=[];t.forEach((t=>{const n=c()({method:"POST",url:`${$t}/types/check`,data:{type:e,value:t},headers:{"Content-Type":"application/json"}});a.push(n)}));try{const t=await Promise.all(a);return t.every((t=>t.data.valid))}catch(n){return!1}},Nt=async(t,e,a,n)=>{let s,o=!1;const r=t;try{if(s=JSON.parse(`[${e}]`),o=await Vt(s,a),!o)throw new Error("Error validating initial state")}catch(i){s=[]}finally{r.attrs.initialState=s;const t=n.graph.getCell(r.id),a=Ct(e);if(t.attr({initialState:{fill:o?Wt:jt,text:`[${a}]`}}),0===n.step){const e=s?s.length:0;r.attrs.count=e,r.attrs.currentState=r.attrs.initialState,r.attrs.currentStateString=s&&s.length?r.attrs.initialStateString:"",t.attr({count:{text:e.toString()}})}}},Pt=(t,e)=>{const a=Object.values(e.attrs.inputs),n=a.every((t=>!!t));if(!n)return"Disabled";const s={};a.forEach((t=>{s[t]=(s[t]||0)+1}));const o=Object.keys(s),r=o.every((e=>{const a=t.elements.find((t=>e===t.id));return a.attrs.count>=s[e]}));return r?"Ready":"Enabled"},Ot=(t,e)=>{const a=t.elements.find((t=>e===t.id));a.attrs.status=Pt(t,a);const n=t.graph.getCell(e);n.attr({body:{stroke:_t[a.attrs.status]}})},zt=(t,e,a)=>{const n=new Date,s=`${(n.getMonth()+1).toString().padStart(2,"0")}/${n.getDate().toString().padStart(2,"0")}/${n.getFullYear().toString().padStart(4,"0")} ${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}:${n.getSeconds().toString().padStart(2,"0")}`;t.logs.push(`[${s}] ${e}`),"success"===a?(0,Tt.bM)({title:"Success",message:e,type:"success"}):"error"===a?Tt.bM.error({title:"Error",message:e}):"info"===a&&Tt.bM.info({title:"Info",message:e})},Ft=(t,e)=>{const a=t.elements.find((t=>e===t.id));a.attrs.outputs.forEach((e=>{const a=t.elements.find((t=>e.transitionId===t.id));a.attrs.inputs[e.portName]=void 0,Ot(t,e.transitionId)})),a.attrs.inputs.forEach((e=>{const a=t.elements.find((t=>e.transitionId===t.id));a.attrs.outputs[e.portName]=a.attrs.output[e.portName].filter((t=>t!==e.transitionId))})),t.graph.removeLinks(t.graph.getCell(e))},At=async(t,e)=>{const a=t.elements.find((t=>e===t.id)),n=Pt(t,a),s={};if("Ready"===n)try{const e=a.attrs.action;if(!e)return;const n=Object.keys(a.attrs.inputs);n.forEach((e=>{const n=t.elements.find((t=>t.id===a.attrs.inputs[e]));s[e]=n.attrs.currentState.pop(),n.attrs.count-=1;const o=JSON.stringify(n.attrs.currentState);n.attrs.currentStateString=o.slice(1,-1);const r=t.graph.getCell(n.id);r.attr({count:{text:n.attrs.count.toString()}})}));const o=await c()({method:"POST",url:`${$t}/actions/${e}/execute`,data:s,headers:{"Content-Type":"application/json"}});n.forEach((e=>{const n=t.elements.find((t=>t.id===a.attrs.inputs[e]));n.attrs.outputs.forEach((e=>{Ot(t,e.transitionId)}))}));const r=Object.keys(a.attrs.outputs);r.forEach((e=>{a.attrs.outputs[e].forEach((a=>{const n=t.elements.find((t=>t.id===a));n.attrs.count+=1,n.attrs.currentState.push(o.data[e]);const s=JSON.stringify(n.attrs.currentState);n.attrs.currentStateString=s.slice(1,-1);const r=t.graph.getCell(n.id);r.attr({count:{text:n.attrs.count.toString()}}),n.attrs.outputs.forEach((e=>{Ot(t,e.transitionId)}))}))})),t.step+=1;const i=`Transition "${a.attrs.label}" fired successfully`;return void zt(t,i,"success")}catch(o){console.log(o);const e=`Failed to fire transition "${a.attrs.label}"`;zt(t,e,"error");const n=Object.keys(s);n.forEach((e=>{const n=a.attrs.inputs[e],o=t.elements.find((t=>t.id===n));o.attrs.currentState.push(s[e]),o.attrs.count+=1;const r=JSON.stringify(o.attrs.currentState);o.attrs.currentStateString=r.slice(1,-1);const i=t.graph.getCell(o.id);i.attr({count:{text:o.attrs.count.toString()}})}))}};var Mt=(0,It.MT)({state:{tool:"cursor",selectedElement:void 0,elements:[],step:0,actions:[],dataTypes:[],graph:void 0,paperEl:void 0,paper:void 0,logs:[]},mutations:{removePlace(t,e){const a=t.elements.find((t=>t.id===e));t.selectedElement&&a.id===t.selectedElement.id&&(t.selectedElement=void 0),a.attrs.outputs.forEach((e=>{const a=t.elements.find((t=>t.id===e.transitionId));a.attrs.inputs[e.portName]=void 0,Ot(t,a.id)})),a.attrs.inputs.forEach((a=>{const n=t.elements.find((t=>t.id===a.transitionId)),s=n.attrs.outputs[a.portName].findIndex((t=>t===e));n.attrs.outputs[a.portName].splice(s,1)}));const n=t.elements.findIndex((t=>t.id===e));t.elements.splice(n,1)},removeTransition(t,e){const a=t.elements.find((t=>t.id===e));t.selectedElement&&a.id===t.selectedElement.id&&(t.selectedElement=void 0);const n=Object.values(a.attrs.inputs);n.forEach((a=>{if(a){const n=t.elements.find((t=>t.id===a));n.attrs.outputs=n.attrs.outputs.filter((t=>t.transitionId!==e))}}));const s=Object.values(a.attrs.outputs);s.forEach((a=>{a.forEach((a=>{if(a){const n=t.elements.find((t=>t.id===a));n.attrs.inputs=n.attrs.inputs.filter((t=>t.transitionId!==e))}}))}));const o=t.elements.findIndex((t=>t.id===e));t.elements.splice(o,1)},removeInputLink(t,e){const a=t.elements.find((t=>t.id===e.placeId)),n=a.attrs.outputs.findIndex((t=>t.transitionId===e.transitionId&&t.portName===e.portName));a.attrs.outputs.splice(n,1);const s=t.elements.find((t=>t.id===e.transitionId));s.attrs.inputs[e.portName]=void 0,Ot(t,e.transitionId)},removeOutputLink(t,e){const a=t.elements.find((t=>t.id===e.placeId)),n=a.attrs.inputs.findIndex((t=>t.transitionId===e.transitionId&&t.portName===e.portName));a.attrs.inputs.splice(n,1);const s=t.elements.find((t=>t.id===e.transitionId)),o=s.attrs.outputs[e.portName].findIndex((t=>t===e.placeId));s.attrs.outputs[e.portName].splice(o,1)},stepForward:async t=>{const e=t.elements.filter((t=>"transition"===t.type&&"Ready"===t.attrs.status)),a=e.length;if(0===a)return void zt(t,"No transition ready","info");const n=Math.floor(Math.random()*a);await At(t,e[n].id)},resetState:async t=>{t.step=0;const e=t.elements.filter((t=>"place"===t.type)),a=[];e.forEach((e=>{a.push(Nt(e,e.attrs.initialStateString,e.attrs.dataType,t))})),await Promise.all(a);const n=t.elements.filter((t=>"transition"===t.type));n.forEach((e=>{Ot(t,e.id)})),zt(t,"Model state reseted","info")},fireTransition:async(t,e)=>{At(t,e)},addInputLink(t,e){const a=t.elements.find((t=>e.placeId===t.id)),n=t.elements.find((t=>e.transitionId===t.id));n.attrs.inputs[e.portName]=e.placeId,a.attrs.outputs.push({transitionId:e.transitionId,portName:e.portName}),Ot(t,e.transitionId)},addOutputLink(t,e){const a=t.elements.find((t=>e.placeId===t.id)),n=t.elements.find((t=>e.transitionId===t.id));n.attrs.outputs[e.portName].push(e.placeId),a.attrs.inputs.push({transitionId:e.transitionId,portName:e.portName})},selectTool(t,e){t.tool=e},addElement(t,e){t.elements.push(e)},selectElement(t,e){t.selectedElement=e},setGraph(t,e){t.graph=e},setPaper(t,e){t.paper=e},setPaperEl(t,e){t.paperEl=e},updateElementLabel(t,e){const a=t.graph.getCell(t.selectedElement.id);a.attr({label:{text:e}})},updateElementDataType:async(t,e)=>{const a=t.graph.getCell(t.selectedElement.id);a.attr({dataType:{text:e}}),await Nt(t.selectedElement,t.selectedElement.attrs.initialStateString,e,t),t.step>0&&(t.selectedElement.attrs.count=0,a.attr({count:{text:"0"}}),t.selectedElement.attrs.currentStateString="",t.selectedElement.attrs.currentState=[]),Ft(t,t.selectedElement.id)},updateElementInitialStateString:async(t,e)=>{await Nt(t.selectedElement,e,t.selectedElement.attrs.dataType,t),t.selectedElement.attrs.outputs.forEach((e=>{Ot(t,e.transitionId)}))},updateElementAction:(t,e)=>{const a=t.actions.find((t=>t.name===e)),n=Object.values(t.selectedElement.attrs.inputs);n.forEach((e=>{if(e){const a=t.elements.find((t=>t.id===e));a.attrs.outputs=a.attrs.outputs.filter((e=>e.transitionId!==t.selectedElement.id))}}));const s=Object.values(t.selectedElement.attrs.outputs);s.forEach((e=>{e.forEach((e=>{const a=t.elements.find((t=>t.id===e));a.attrs.inputs=a.attrs.inputs.filter((e=>e.transitionId!==t.selectedElement.id))}))}));const o=t.graph.getCell(t.selectedElement.id);t.selectedElement.attrs.action=a.name,t.selectedElement.attrs.inputs={},t.selectedElement.attrs.outputs={},o.attr({action:{text:a.name}}),o.removePorts(o.getPorts());const r=Object.keys(a.inputs);r.forEach((e=>{o.addPort({group:"input",attrs:{circle:{"data-name":e,"data-type":a.inputs[e]},text:{text:`${e}:${a.inputs[e]}`}}}),t.selectedElement.attrs.inputs[e]=void 0}));const i=Object.keys(a.outputs);i.forEach((e=>{o.addPort({group:"output",attrs:{circle:{"data-name":e,"data-type":a.outputs[e]},text:{text:`${e}:${a.outputs[e]}`}}}),t.selectedElement.attrs.outputs[e]=[]})),t.selectedElement.attrs.status=Pt(t,t.selectedElement),"Disabled"===t.selectedElement.attrs.status?o.attr({body:{stroke:jt}}):"Enabled"===t.selectedElement.attrs.status?o.attr({body:{stroke:"#8f8f8f"}}):"Ready"===t.selectedElement.attrs.status&&o.attr({body:{stroke:Wt}})}},getters:{paper(t){return t.paper},graph(t){return t.graph},paperEl(t){return t.paperEl},actions(t){return t.actions},dataTypes(t){return t.dataTypes},getElementById:t=>e=>t.elements.find((t=>e===t.id)),getCellById:t=>e=>t.graph.getCell(e),getCellViewById:t=>e=>t.paper.findViewByModel(t.graph.getCell(e)),selectedElement(t){return t.selectedElement},tool(t){return t.tool},step(t){return t.step},logsString(t){return t.logs.toString()}},actions:{},modules:{}}),Dt=t=>{t.use(Tt.ZP)},Lt=({domNode:t}={})=>{o.vI.add(i.mRB),o.vI.add(l.NC),o.vz.watch();const e=(0,n.ri)(y);Dt(e),e.component("font-awesome-icon",r.GN),e.use(s.Z),e.use(p(),c()),e.use(Mt).use(kt).mount(t||"#app")};Lt()}},e={};function a(n){var s=e[n];if(void 0!==s)return s.exports;var o=e[n]={id:n,loaded:!1,exports:{}};return t[n].call(o.exports,o,o.exports,a),o.loaded=!0,o.exports}a.m=t,function(){var t=[];a.O=function(e,n,s,o){if(!n){var r=1/0;for(c=0;c<t.length;c++){n=t[c][0],s=t[c][1],o=t[c][2];for(var i=!0,l=0;l<n.length;l++)(!1&o||r>=o)&&Object.keys(a.O).every((function(t){return a.O[t](n[l])}))?n.splice(l--,1):(i=!1,o<r&&(r=o));if(i){t.splice(c--,1);var d=s();void 0!==d&&(e=d)}}return e}o=o||0;for(var c=t.length;c>0&&t[c-1][2]>o;c--)t[c]=t[c-1];t[c]=[n,s,o]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,n){var s,o,r=n[0],i=n[1],l=n[2],d=0;for(s in i)a.o(i,s)&&(a.m[s]=i[s]);if(l)var c=l(a);for(e&&e(n);d<r.length;d++)o=r[d],a.o(t,o)&&t[o]&&t[o][0](),t[r[d]]=0;return a.O(c)},n=self["webpackChunkpontosim"]=self["webpackChunkpontosim"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(7937)}));n=a.O(n)})();
//# sourceMappingURL=app.f59567e8.js.map